<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>CIVIL REGISTRY INFORMATION SYSTEM</title>
        <link rel="stylesheet" href="style.css">
        <script type="text/javascript" src="js.js" defer></script>
    </head>

    <body>
         <nav id="sidebar">
            <ul>
                <li>
                    <span class="logo">CIVIL REGISTRY</span>
                    <button onclick=toggleSidebar() id="toggle-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M440-240 200-480l240-240 56 56-183 184 183 184-56 56Zm264 0L464-480l240-240 56 56-183 184 183 184-56 56Z"/></svg>
                    </button> 
                </li>

                <li>
                    <a href="admin.html" id="logout-button">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#E3E3E3"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h280v80H200Zm440-160-55-58 102-102H360v-80h327L585-622l55-58 200 200-200 200Z"/></svg>
                        <span>Logout</span>
                    </a>
                </li>
            </ul>
        </nav>
       
       
         <main>
           
            <!-- Accessibility Trigger -->
            <button class="accessibility-trigger" onclick="toggleAccessibilityPanel()">
                <span style="font-size: 18px;"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-720q-33 0-56.5-23.5T400-800q0-33 23.5-56.5T480-880q33 0 56.5 23.5T560-800q0 33-23.5 56.5T480-720ZM360-80v-520q-60-5-122-15t-118-25l20-80q78 21 166 30.5t174 9.5q86 0 174-9.5T820-720l20 80q-56 15-118 25t-122 15v520h-80v-240h-80v240h-80Z"/></svg></span>
                <span class="accessibility-text">accessibility</span>
            </button>

            <!-- Accessibility Panel -->
            <div class="accessibility-panel" id="accessibilityPanel">
                <div class="panel-header">Accessibility Tool</div>
   
                <div class="accessibility-option" onclick="adjustFontSize()">
                    <div class="option-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m40-200 210-560h100l210 560h-96l-51-143H187l-51 143H40Zm176-224h168l-82-232h-4l-82 232Zm504 104v-120H600v-80h120v-120h80v120h120v80H800v120h-80Z"/></svg></div>
                    <div class="option-text">Readable Fonts</div>
                </div>
   
                <div class="accessibility-option" onclick="toggleHighContrast()">
                    <div class="option-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-120q-133 0-226.5-92.5T160-436q0-66 25-122t69-100l226-222 226 222q44 44 69 100t25 122q0 131-93.5 223.5T480-120Zm0-80v-568L310-600q-35 33-52.5 74.5T240-436q0 97 70 166.5T480-200Z"/></svg></div>
                    <div class="option-text">Color Contrast</div>
                </div>
   
                <div class="accessibility-option" onclick="toggleUnderlineLinks()">
                    <div class="option-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M80 0v-160h800V0H80Zm140-280 210-560h100l210 560h-96l-50-144H368l-52 144h-96Zm176-224h168l-82-232h-4l-82 232Z"/></svg></div>
                    <div class="option-text">Link Underline</div>
                </div>
   
                <div class="accessibility-option" onclick="resetAccessibility()">
                    <div class="option-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M482-160q-134 0-228-93t-94-227v-7l-64 64-56-56 160-160 160 160-56 56-64-64v7q0 100 70.5 170T482-240q26 0 51-6t49-18l60 60q-38 22-78 33t-82 11Zm278-161L600-481l56-56 64 64v-7q0-100-70.5-170T478-720q-26 0-51 6t-49 18l-60-60q38-22 78-33t82-11q134 0 228 93t94 227v7l64-64 56 56-160 160Z"/></svg></div>
                    <div class="option-text">Reset</div>
                </div>
   
                <div class="accessibility-option" onclick="showAccessibilityStatement()">
                    <div class="option-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-280q17 0 28.5-11.5T520-320q0-17-11.5-28.5T480-360q-17 0-28.5 11.5T440-320q0 17 11.5 28.5T480-280Zm-40-160h80v-240h-80v240Zm40 360q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg></div>
                    <div class="option-text">Accessibility Statement</div>
                </div>

                <div class="theme-section">
                    <div class="theme-controls">
                        <div class="theme-option">
                            <div class="theme-icon dark"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#000000"><path d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Zm0-80q88 0 158-48.5T740-375q-20 5-40 8t-40 3q-123 0-209.5-86.5T364-660q0-20 3-40t8-40q-78 32-126.5 102T200-480q0 116 82 198t198 82Zm-10-270Z"/></svg></div>
                            <span>Dark</span>
                        </div>
           
                        <div class="toggle-switch" id="themeToggle" onclick="toggleTheme()">
                            <div class="toggle-slider"></div>
                        </div>
           
                        <div class="theme-option">
                            <div class="theme-icon light"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#000000"><path d="M480-360q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0 80q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Zm326-268Z"/></svg></div>
                            <span>Light</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scroll to Top Button -->
            <button class="scroll-top" id="scrollTopBtn" onclick="scrollToTop()">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#E3E3E3"><path d="M480-528 296-344l-56-56 240-240 240 240-56 56-184-184Z"/></svg>
            </button>

                <div class="header">
                <h2 style="text-align:left;">Welcome, Admin!</h2>                    
            </div>
            

      <style>
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
  }

  th, td {
    padding: 12px;
    border-bottom: 1px solid #ccc;
    text-align: left;
  }

  th {
    background-color: #1A202C;
    color: e3e3e3;
  }

  .btn {
    padding: 6px 10px;
    font-size: 13px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }

  .btn-release {
    background-color: #28a745;
    color: #fff;
  }

  .btn-undo {
    background-color: #ffc107;
    color: #000;
  }

  input[type="file"] {
    font-size: 12px;
  }

  .file-download {
    color: green;
    text-decoration: none;
  }
</style>

<h2>Document Release & Delivery</h2>

<table>
  <thead>
    <tr>
      <th>Form Type</th>
      <th>Full Name</th>
      <th>Tracking Number</th>
      <th>Proof of Release</th>
      <th>Released At</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody id="releaseTable">
    <!-- Dynamic rows -->
  </tbody>
</table>

<!-- Optional Modal for Preview -->
<div id="previewModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.7); align-items:center; justify-content:center;">
  <div style="background:#fff; padding:20px; max-width:80%; max-height:80%; overflow:auto;">
    <button onclick="closePreview()" style="float:right;">Close</button>
    <div id="previewContent"></div>
  </div>
</div>

<script>
  const releaseTable = document.getElementById('releaseTable');
  const previewModal = document.getElementById('previewModal');
  const previewContent = document.getElementById('previewContent');
  let requests = JSON.parse(localStorage.getItem('documentRequests') || '[]');

  function saveRequests() {
    localStorage.setItem('documentRequests', JSON.stringify(requests));
  }

  function renderReleaseTable() {
    releaseTable.innerHTML = '';
    requests.forEach((req, index) => {
      const released = req.released || false;
      const proofData = req.releaseProof?.data || '';
      const proofName = req.releaseProof?.name || '';
      const releasedAt = req.releasedAt || 'â€”';

      const fileLink = proofData
        ? `<a href="#" onclick="previewFile('${proofData}')" class="file-download"> ${proofName}</a>`
        : '<em>No proof</em>';

      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${capitalizeFirst(req.formType)}</td>
        <td>${req.fullName}</td>
        <td>${req.trackingNumber}</td>
        <td>${fileLink}</td>
        <td>${released ? releasedAt : 'â€”'}</td>
        <td>
          ${!released ? `
            <div style="display: flex; align-items: center; gap: 6px; flex-wrap: wrap;">
              <input type="file" accept=".jpg,.jpeg,.png,.pdf" onchange="uploadReleaseProof(event, ${index})" style="max-width: 150px;">
              <button class="btn btn-release" onclick="markAsReleased(${index})" ${proofData ? '' : 'disabled'}>Release</button>
            </div>
          ` : `
            <button class="btn btn-undo" onclick="undoRelease(${index})">Undo</button>
          `}
        </td>
      `;
      releaseTable.appendChild(row);
    });
  }

  function capitalizeFirst(str) {
    return str ? str.charAt(0).toUpperCase() + str.slice(1) : '';
  }

  function uploadReleaseProof(e, index) {
    const file = e.target.files[0];
    if (file && file.size <= 1024 * 1024) { // limit 1MB
      const reader = new FileReader();
      reader.onload = function(event) {
        requests[index].releaseProof = {
          name: file.name,
          data: event.target.result
        };
        saveRequests();
        renderReleaseTable();
      };
      reader.readAsDataURL(file);
    } else {
      alert("File too large or not supported. Limit: 1MB");
    }
  }

  function markAsReleased(index) {
    if (!requests[index].releaseProof) {
      alert("Please upload proof before marking as released.");
      return;
    }
    requests[index].released = true;
    requests[index].releasedAt = new Date().toLocaleString();
    saveRequests();
    renderReleaseTable();
  }

  function undoRelease(index) {
    requests[index].released = false;
    requests[index].releasedAt = null;
    saveRequests();
    renderReleaseTable();
  }

  function previewFile(dataURL) {
    previewContent.innerHTML = dataURL.includes('pdf')
      ? `<iframe src="${dataURL}" style="width:100%; height:500px;"></iframe>`
      : `<img src="${dataURL}" style="max-width:100%; max-height:500px;">`;
    previewModal.style.display = 'flex';
  }

  function closePreview() {
    previewModal.style.display = 'none';
    previewContent.innerHTML = '';
  }

  renderReleaseTable();
</script>

           
           
        </main>
    </body>
</html>
